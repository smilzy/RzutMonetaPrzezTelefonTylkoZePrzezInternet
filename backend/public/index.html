<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Rzut Monet Przez Telefon (Tylko 呕e Przez Internet ;))</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <button id="theme-toggle" title="Przecz motyw"></button>
  <h1>Rzut Monet Przez Telefon<br><span style="font-size:0.7em; font-weight:normal;">(Tylko 呕e Przez Internet ;))</span></h1>
  <div id="room-setup" class="centered-col">
    <button id="create-room" class="big-btn" style="margin-bottom:2em;">Utw贸rz pok贸j</button>
    <div class="centered-row">
      <input id="room-id" class="big-input" placeholder="Wpisz ID pokoju" />
      <button id="join-room" class="big-btn">Docz do pokoju</button>
    </div>
    <input id="player-nick" class="big-input" placeholder="Tw贸j nick (opcjonalnie)" style="margin-top:0.5em;" />
    <div id="room-link" style="display:none"></div>
  </div>
  <div id="prime-setup" class="centered-col" style="display:none;">
    <button id="prime-start-btn" class="big-btn" style="margin-bottom:2em;">Utw贸rz now gr (liczby pierwsze)</button>
    <div id="prime-game-panel" style="display:none;"></div>
  </div>
  <!-- Przyciski wyboru trybu gry w prawym g贸rnym rogu -->
  <div style="position:fixed;top:18px;right:170px;z-index:10001;display:flex;gap:0.5em;">
    <button id="classic-mode-btn" class="big-btn" style="font-size:1.1em;padding:0.5em 1.2em;">Gra klasyczna</button>
    <button id="prime-mode-btn" class="big-btn" style="font-size:1.1em;padding:0.5em 1.2em;">Gra na liczby pierwsze</button>
  </div>
  <button id="open-debug-modal" style="position:fixed;top:18px;right:18px;z-index:10001;font-size:1.1em;padding:0.5em 1.2em;background:#1a237e;color:#fff;border:none;border-radius:8px;box-shadow:0 2px 8px #0002;cursor:pointer;">Debug info</button>
  <div id="game" class="hidden" style="position:relative;">
    <div id="boom-skull" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.97); z-index:9999; text-align:center; padding-top:5em;">
      <img id="skull-img" src="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExa2o1d3J4d3M2MWVkdjkzMWE4NDZwZmF3MjM0aHoxZ3l4YTh3ZmVjaSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/QNuQ2a8DZUJU0QOHPd/giphy.gif" alt="BOOM!" style="width:120px;">
      <div style="font-size:2em; color:#b71c1c; font-weight:bold; margin-top:1em;">BOOM! nie 偶yjesz, hahahahaha</div>
    </div>
    <div id="game-content">
      <div id="room-info" class="room-id-box centered-row" style="display:none; flex-direction:row; align-items:center; justify-content:center; gap:1em;">
        <span id="room-id-label" style="font-size:1.3em;">ID pokoju: <b id="room-id-game" style="font-size:1.3em;"></b></span>
        <button id="copy-room-id" class="copy-btn">Kopiuj</button>
        <span class="copy-tooltip" id="copy-tooltip">Kliknij, aby skopiowa</span>
      </div>
    </div>
  </div>
  <div id="game-flow" style="text-align:center;margin-top:2em;">
    <img id="cwaniak-img" src="https://static.pomagam.pl/media/project_photos/cache/UNvPmRE2Cgsk.jpg" alt="cwaniak" style="width:340px; border-radius:10px; margin-bottom:1em;">
    <button id="throw-coin-btn" class="big-btn" style="font-size:2em;">JA JESTEM CWANIAK</button>
    <div id="waiting-cwaniak" style="display:none; font-size:1.3em; color:#1a237e; margin-top:2em;">
      <span class="loader"></span>
      OCZEKIWANIE NA DRUGIEGO CWANIAKA
    </div>
    <div id="choose-section" style="display:none;">
      <div id="pojedynek-message" style="font-size:1.2em;font-weight:bold;color:#b71c1c;margin-bottom:1em;"></div>
      <img id="coin-gif" src="https://media4.giphy.com/media/MOsuJf3qp3b1fQx2Iv/giphy.gif?cid=6c09b952fwmeraqx4dliut78mqlcmhs8s0imidrlxqupfu79&ep=v1_internal_gif_by_id&rid=giphy.gif&ct=s" alt="Rzut monet" style="width:340px; border-radius:18px; margin-bottom:1em; box-shadow:0 4px 24px #0002;">
      <div class="timer-bar" style="width:70%;height:18px;background:#eee;border-radius:9px;margin:1.2em auto 0;overflow:hidden;">
        <div class="timer-bar-inner" id="guess-timer-bar-main" style="height:100%;background:linear-gradient(90deg,#43a047,#fbc02d);width:100%;transition:width 0.2s linear;"></div>
      </div>
      <div id="choose-title" style="font-size:2.1em;font-weight:bold;color:#1a237e;margin-bottom:1.2em;">Wybierz stron monety</div>
      <div id="choose-row" style="display:flex;justify-content:center;gap:2em;">
        <button class="guess-btn guess-btn-main" id="guess-awers-main">
          <img src="https://numizmatyczny.com/userdata/public/gfx/13406/Moneta-5-zl-Opactwo-Benedyktynow-w-Tyncu-awers.jpg" alt="Awers" style="width:220px;border-radius:50%;border:3px solid #888;">
          <div style="font-size:1.3em;margin-top:0.5em;">Awers</div>
        </button>
        <button class="guess-btn guess-btn-main" id="guess-rewers-main">
          <img src="https://numizmatyczny.com/userdata/public/gfx/13407/Moneta-5-zl-Opactwo-Benedyktynow-w-Tyncu-rewers.jpg" alt="Rewers" style="width:220px;border-radius:50%;border:3px solid #888;">
          <div style="font-size:1.3em;margin-top:0.5em;">Rewers</div>
        </button>
      </div>
      <div id="waiting-info-main" style="margin-top:1.5em;font-size:1.2em;color:#1a237e;display:none;"><span class="loader"></span> Oczekiwanie na wyb贸r drugiego cwaniaka...</div>
    </div>
    <div id="guess-result-main" class="guess-result"></div>
  </div>
  <!-- Modal startowy -->
  <div id="start-modal">
    <button class="close-btn" id="close-start-modal" title="Zamknij">&times;</button>
    <img class="coin-gif" src="https://media4.giphy.com/media/MOsuJf3qp3b1fQx2Iv/giphy.gif?cid=6c09b952fwmeraqx4dliut78mqlcmhs8s0imidrlxqupfu79&ep=v1_internal_gif_by_id&rid=giphy.gif&ct=s" alt="Rzut monet">
    <div class="big-title">RZU</div>
  </div>
  <!-- Modal debug info -->
  <div id="debug-modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.45);z-index:10002;text-align:center;">
    <div style="background:#fff;max-width:520px;margin:7vh auto 0 auto;padding:2em 2em 1.5em 2em;border-radius:18px;box-shadow:0 4px 24px #0003;position:relative;">
      <button id="close-debug-modal" style="position:absolute;top:0.7em;right:1em;font-size:2em;background:none;border:none;color:#888;cursor:pointer;">&times;</button>
      <div style="font-size:1.3em;font-weight:bold;margin-bottom:1em;color:#1a237e;">Debug info</div>
      <div style="background:#f8f8f8;border:1px solid #ccc;border-radius:8px;padding:1em;font-size:1em;text-align:left;">
        <div>Commitment: <span id="debug-commitment"></span></div>
        <div>Bit: <span id="debug-bit"></span></div>
        <div>Nonce: <span id="debug-nonce"></span></div>
      </div>
      <div class="steps-row" style="margin-top:2em;">
        <div class="step-box">
          <div class="step-title">1. Commitment</div>
          <button id="commit-btn" class="big-btn">Wylij commitment</button>
          <div id="commitment-status" class="step-status"></div>
        </div>
        <div class="step-box">
          <div class="step-title">2. Reveal</div>
          <button id="reveal-btn" class="big-btn hidden">Ujawnij bit</button>
          <div id="reveal-status" class="step-status"></div>
        </div>
        <div class="step-box">
          <div class="step-title">3. Wynik</div>
          <button id="check-result" class="big-btn hidden">Sprawd藕 wynik</button>
          <div id="result-status" class="step-status"></div>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="state.js"></script>
  <script type="module" src="roomView.js"></script>
  <script type="module" src="mainPage.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html> 
